#### TLS四次握手

第一次：

客户端向服务器发送明文，包括客户端支持的协议版本、加密套件、压缩算法和随机数R1.

加密套件：认证算法、密钥交换算法、对称加密算法、信息摘要算法

第二次：

服务器回应，以明文的形式，确认协议版本、随机数R2,将服务器自己的公钥证书发给客户端

第三次握手前客户端先进行证书验证，有效期，有效，根据证书链从根CA开始验证直到网站证书

验证通过的话，再生成一个随机数Pre-master,用服务器的公钥进行加密

第三次：

发送Pre-master Key给服务器，服务器用自己的私钥进行解密，得到第三个随机数，到这里为止客户端和服务器端都有了三个随机数，两边用相同的算法，用这三个随机数生成一个密钥，用于握手结束后传输数据 的对称加密

第四次：

服务器向客户端通知，后面发送的消息都用协商的密钥进行加密。